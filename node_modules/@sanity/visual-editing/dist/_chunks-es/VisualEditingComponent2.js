import{useRef as e,useState as r,useEffect as t}from"react";import{useNavigate as n,useRevalidator as a,useLocation as s}from"react-router";import{e as o}from"./enableVisualEditing.js";function u(u){const{components:p,refresh:c,zIndex:l}=u,i=n(),h=e(i),[m,d]=r(),f=a(),[y,b]=r(null),[v,x]=r(!1);t((()=>{h.current=i}),[i]),t((()=>{y&&"loading"===f.state?x(!0):y&&v&&"idle"===f.state&&(y(),b(null),x(!1))}),[v,f.state,y]),t((()=>{const e=o({components:p,zIndex:l,refresh:e=>{function r(){return("mutation"!==e.source||!e.livePreviewEnabled)&&new Promise((e=>{f.revalidate(),b((()=>e))}))}return c?c(e,r):r()},history:{subscribe:e=>(d((()=>e)),()=>d(void 0)),update:e=>{"push"===e.type||"replace"===e.type?h.current(e.url,{replace:"replace"===e.type}):"pop"===e.type&&h.current(-1)}}});return()=>e()}),[p,c,f,l]);const $=s();return t((()=>{m&&m({type:"push",url:`${$.pathname}${$.search}${$.hash}`})}),[$.hash,$.pathname,$.search,m]),null}export{u as default};//# sourceMappingURL=VisualEditingComponent2.js.map

import{useNavigate as e,useRevalidator as r,useLocation as t}from"@remix-run/react";import{useRef as n,useState as a,useEffect as s}from"react";import{e as o}from"./enableVisualEditing.js";function u(u){const{components:p,refresh:c,zIndex:i}=u,l=e(),h=n(l),[m,d]=a(),f=r(),[y,b]=a(null),[v,x]=a(!1);s((()=>{h.current=l}),[l]),s((()=>{y&&"loading"===f.state?x(!0):y&&v&&"idle"===f.state&&(y(),b(null),x(!1))}),[v,f.state,y]),s((()=>{const e=o({components:p,zIndex:i,refresh:e=>{function r(){return("mutation"!==e.source||!e.livePreviewEnabled)&&new Promise((e=>{f.revalidate(),b((()=>e))}))}return c?c(e,r):r()},history:{subscribe:e=>(d((()=>e)),()=>d(void 0)),update:e=>{"push"===e.type||"replace"===e.type?h.current(e.url,{replace:"replace"===e.type}):"pop"===e.type&&h.current(-1)}}});return()=>e()}),[p,c,f,i]);const $=t();return s((()=>{m&&m({type:"push",url:`${$.pathname}${$.search}${$.hash}`})}),[$.hash,$.pathname,$.search,m]),null}export{u as default};//# sourceMappingURL=VisualEditingComponent3.js.map
